{"mappings":"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","sources":["src/src/modules/module-interface.ts","src/src/modules/auth/auth-repository.ts","src/src/core/config/env/index.ts","src/src/core/helpers/error.ts","src/src/core/interfaces/response-interface.ts","src/src/core/helpers/response.ts","src/src/core/middlewares/auth/verifyToken.ts","src/src/core/providers/nodemailer.ts","src/src/modules/auth/auth-interfaces.ts","src/src/modules/auth/auth-service.ts","src/src/modules/auth/auth-controller.ts","src/src/modules/auth/auth-router.ts","src/src/modules/auth/auth-module.ts","src/src/core/interfaces/global-interface.ts","src/src/core/helpers/_globals.ts","src/src/index.ts","src/index.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"'use strict'\r\nimport fs from 'fs'\r\nimport express, { Application, Router } from 'express'\r\nimport { Module } from './modules/module-interface'\r\nimport cors from 'cors'\r\nimport { verifyToken } from './core/middlewares/auth/verifyToken'\r\nimport { Config } from './core/config/env'\r\nimport AuthModule from './modules/auth/auth-module'\r\nimport morgan from 'morgan'\r\nimport path from 'path'\r\n\r\nexport type {\r\n  SearchDatabase,\r\n  SearchGetPayload,\r\n  SearchPayload,\r\n} from './core/interfaces/global-interface'\r\nexport { onSuccess, onError } from './core/helpers/response'\r\nexport { Global } from './core/helpers/_globals'\r\nexport { sendEmail } from './core/providers/nodemailer'\r\nexport * from './core/helpers/error'\r\nexport { verifyToken } from './core/middlewares/auth/verifyToken'\r\nexport interface Bootstrap {\r\n  modules: Array<Module>\r\n  context: string\r\n  version: string\r\n}\r\nexport class PullupModules implements Bootstrap {\r\n  public modules: Array<Module> = [new AuthModule('auth')]\r\n  public context: string\r\n  public version: string\r\n  private _env: Config\r\n\r\n  constructor(modules: Array<Module>) {\r\n    this._env = Config.instance\r\n    this.modules = this.modules.concat(modules)\r\n    this.context = this._env.config.apiContext || 'api'\r\n    this.version = this._env.config.apiVersion || 'v1'\r\n  }\r\n\r\n  public bootstrap() {\r\n    const router: Router = Router()\r\n    const app: Application = express()\r\n\r\n    app.disable('x-powered-by')\r\n    app.use(morgan('dev'))\r\n    app.use(\r\n      cors({\r\n        allowedHeaders: [\r\n          'Origin',\r\n          'X-Requested-With',\r\n          'Content-Type',\r\n          'queue-token',\r\n          'Accept',\r\n          'X-Access-Token',\r\n          'Authorization',\r\n        ],\r\n        credentials: true,\r\n        methods: 'GET,HEAD,OPTIONS,PUT,PATCH,POST,DELETE',\r\n        origin: '*',\r\n        preflightContinue: false,\r\n      })\r\n    )\r\n    app.use(express.json({ limit: '300mb' }))\r\n    app.use(express.urlencoded({ extended: true }))\r\n\r\n    const moduleOcurrencies = this.modules.filter(\r\n      (module) => module.moduleName === 'auth'\r\n    )\r\n    if (moduleOcurrencies.length > 1) this.modules.shift()\r\n\r\n    this.modules.forEach((module) => {\r\n      router.use(\r\n        `/${this.context}/${this.version}/${module.moduleName}`,\r\n        -!module.isPublic ? verifyToken : (_, __, next) => next(),\r\n        module.router.router\r\n      )\r\n    })\r\n    app.use(router)\r\n\r\n    app\r\n      .listen(process.env.PORT || this._env.config.serverPort, () => {\r\n        console.log(\r\n          `Server up and running on port: ${this._env.config.serverPort} `\r\n        )\r\n      })\r\n      .on('error', (error) => console.error(`Error: ${error}`))\r\n\r\n    return app\r\n  }\r\n}\r\n\r\nexport class StartModules {\r\n  modules: Array<string>\r\n  folderName: string = 'unknow'\r\n  constructor(modules: Array<string>, folderName: string = 'unknowContext') {\r\n    this.folderName = folderName\r\n    this.modules = modules\r\n  }\r\n\r\n  async createModules(srcDirName: string) {\r\n    const moduleFiles: string[] = []\r\n    let files: any\r\n    if (!fs.existsSync(`${srcDirName}/modules`)) {\r\n      fs.mkdirSync(`${srcDirName}/modules`, { recursive: true })\r\n    }\r\n\r\n    files = fs.readdirSync(`${srcDirName}/modules`)\r\n\r\n    this.modules.forEach((module) => {\r\n      let isOk = true\r\n      for (const file in files) {\r\n        if (file === module) {\r\n          isOk = false\r\n        }\r\n      }\r\n      if (isOk) {\r\n        moduleFiles.push(module)\r\n      }\r\n    })\r\n\r\n    moduleFiles.forEach((moduleFile) => {\r\n      let modelName = moduleFile.charAt(0).toUpperCase() + moduleFile.slice(1)\r\n      if (!fs.existsSync(path.resolve(srcDirName, 'modules', moduleFile))) {\r\n        fs.mkdir(\r\n          `${srcDirName}/modules/${moduleFile}`,\r\n          { recursive: true },\r\n          (err) => {\r\n            if (err) console.error(err)\r\n          }\r\n        )\r\n\r\n        if (\r\n          fs.existsSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/controller-sample.txt'\r\n          )\r\n        ) {\r\n          let controller = fs.readFileSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/controller-sample.txt'\r\n          )\r\n          const controllerCode = Buffer.from(controller)\r\n            .toString()\r\n            .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n            .replace(/{{MODEL_NAME}}/g, modelName)\r\n          fs.writeFile(\r\n            `${srcDirName}/modules/${moduleFile}/${moduleFile}-controller.ts`,\r\n            controllerCode,\r\n            (err) => {\r\n              if (err) console.error(err)\r\n              else {\r\n                console.info(\r\n                  `${modelName} Controller File written successfully`\r\n                )\r\n              }\r\n            }\r\n          )\r\n        } else {\r\n          console.info('Controller File not written')\r\n        }\r\n\r\n        if (\r\n          fs.existsSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/router-sample.txt'\r\n          )\r\n        ) {\r\n          let controller = fs.readFileSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/router-sample.txt'\r\n          )\r\n          const controllerCode = Buffer.from(controller)\r\n            .toString()\r\n            .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n            .replace(/{{MODEL_NAME}}/g, modelName)\r\n          fs.writeFile(\r\n            `${srcDirName}/modules/${moduleFile}/${moduleFile}-router.ts`,\r\n            controllerCode,\r\n            (err) => {\r\n              if (err) console.error(err)\r\n              else {\r\n                console.info(`${modelName} Router File written successfully`)\r\n              }\r\n            }\r\n          )\r\n        } else {\r\n          console.info('Router File not written')\r\n        }\r\n\r\n        if (\r\n          fs.existsSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/service-sample.txt'\r\n          )\r\n        ) {\r\n          let controller = fs.readFileSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/service-sample.txt'\r\n          )\r\n          const controllerCode = Buffer.from(controller)\r\n            .toString()\r\n            .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n            .replace(/{{MODEL_NAME}}/g, modelName)\r\n          fs.writeFile(\r\n            `${srcDirName}/modules/${moduleFile}/${moduleFile}-service.ts`,\r\n            controllerCode,\r\n            (err) => {\r\n              if (err) console.error(err)\r\n              else {\r\n                console.info(`${modelName} Service File written successfully`)\r\n              }\r\n            }\r\n          )\r\n        } else {\r\n          console.info('Service File not written')\r\n        }\r\n\r\n        if (\r\n          fs.existsSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/repository-sample.txt'\r\n          )\r\n        ) {\r\n          let controller = fs.readFileSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/repository-sample.txt'\r\n          )\r\n          const controllerCode = Buffer.from(controller)\r\n            .toString()\r\n            .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n            .replace(/{{MODEL_NAME}}/g, modelName)\r\n          fs.writeFile(\r\n            `${srcDirName}/modules/${moduleFile}/${moduleFile}-repository.ts`,\r\n            controllerCode,\r\n            (err) => {\r\n              if (err) console.error(err)\r\n              else {\r\n                console.info(\r\n                  `${modelName} Repository File written successfully`\r\n                )\r\n              }\r\n            }\r\n          )\r\n        } else {\r\n          console.info('Repository File not written')\r\n        }\r\n\r\n        if (\r\n          fs.existsSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/module-sample.txt'\r\n          )\r\n        ) {\r\n          let controller = fs.readFileSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/module-sample.txt'\r\n          )\r\n          const controllerCode = Buffer.from(controller)\r\n            .toString()\r\n            .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n            .replace(/{{MODEL_NAME}}/g, modelName)\r\n          fs.writeFile(\r\n            `${srcDirName}/modules/${moduleFile}/${moduleFile}-module.ts`,\r\n            controllerCode,\r\n            (err) => {\r\n              if (err) console.error(err)\r\n              else {\r\n                console.info(`${modelName} Module File written successfully`)\r\n              }\r\n            }\r\n          )\r\n        } else {\r\n          console.info('Module File not written')\r\n        }\r\n\r\n        if (\r\n          fs.existsSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/interfaces-sample.txt'\r\n          )\r\n        ) {\r\n          let controller = fs.readFileSync(\r\n            srcDirName +\r\n              '/node_modules/@pablo-dav/modular-api/samples/interfaces-sample.txt'\r\n          )\r\n          const controllerCode = Buffer.from(controller)\r\n            .toString()\r\n            .replace(/{{MODULE_NAME}}/g, moduleFile)\r\n            .replace(/{{MODEL_NAME}}/g, modelName)\r\n          fs.writeFile(\r\n            `${srcDirName}/modules/${moduleFile}/${moduleFile}-interfaces.ts`,\r\n            controllerCode,\r\n            (err) => {\r\n              if (err) console.error(err)\r\n              else {\r\n                console.info(\r\n                  `${modelName} Interfaces File written successfully`\r\n                )\r\n                console.info(\r\n                  '\\n-----------------------------------------------------------------\\n'\r\n                )\r\n              }\r\n            }\r\n          )\r\n        } else {\r\n          console.info('Interfaces File not written')\r\n          console.info(\r\n            '\\n-----------------------------------------------------------------\\n'\r\n          )\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  removeModule(srcDirName: string, name: string) {\r\n    if (fs.existsSync(`${srcDirName}/modules/${name}`)) {\r\n      fs.rmdir(\r\n        `${srcDirName}/modules/${name}`,\r\n        { recursive: true },\r\n        (error) => {\r\n          if (error) {\r\n            console.error(error)\r\n          } else {\r\n            console.log('Folder Deleted!')\r\n          }\r\n        }\r\n      )\r\n    }\r\n  }\r\n}\r\n"],"names":[],"version":3,"file":"types.d.ts.map"}